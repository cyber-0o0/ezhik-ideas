<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Ezhik AI Hub üê°</title>
  <link rel="stylesheet" href="style.css">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      min-height: 100vh;
      color: #e2e8f0;
      padding-bottom: 80px;
    }
    .header {
      background: rgba(99, 102, 241, 0.2);
      backdrop-filter: blur(10px);
      padding: 20px;
      text-align: center;
      border-bottom: 1px solid rgba(99, 102, 241, 0.3);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .header h1 { font-size: 24px; margin-bottom: 5px; }
    .header p { font-size: 12px; color: #94a3b8; }
    
    /* Tabs */
    .tabs {
      display: flex;
      gap: 5px;
      padding: 10px 15px;
      overflow-x: auto;
      background: rgba(0,0,0,0.2);
      -webkit-overflow-scrolling: touch;
    }
    .tab {
      padding: 10px 16px;
      background: transparent;
      border: none;
      color: #94a3b8;
      font-size: 13px;
      cursor: pointer;
      white-space: nowrap;
      border-radius: 20px;
      transition: all 0.2s;
    }
    .tab.active {
      background: #6366f1;
      color: white;
    }
    .tab:hover:not(.active) { background: rgba(99, 102, 241, 0.2); }
    
    /* Content */
    .content { padding: 20px; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    
    /* Common */
    .card {
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 15px;
    }
    .btn {
      background: #6366f1;
      color: white;
      border: none;
      padding: 14px 24px;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      transition: all 0.2s;
    }
    .btn:hover { background: #4f46e5; transform: translateY(-2px); }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .btn-secondary { background: rgba(255,255,255,0.1); }
    
    input, select, textarea {
      width: 100%;
      padding: 14px;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      color: white;
      font-size: 15px;
      margin-bottom: 12px;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #6366f1;
    }
    textarea { min-height: 100px; resize: vertical; }
    
    .result {
      background: rgba(99, 102, 241, 0.1);
      border: 1px solid rgba(99, 102, 241, 0.3);
      border-radius: 12px;
      padding: 16px;
      margin-top: 15px;
      white-space: pre-wrap;
      line-height: 1.6;
    }
    .result.loading {
      color: #94a3b8;
      font-style: italic;
    }
    
    .tool-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }
    .tool-item {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }
    .tool-item:hover { background: rgba(99, 102, 241, 0.2); }
    .tool-icon { font-size: 28px; margin-bottom: 5px; }
    .tool-name { font-size: 12px; color: #94a3b8; }
    
    /* Stats */
    .stats-bar {
      display: flex;
      justify-content: center;
      gap: 20px;
      padding: 10px;
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      margin-bottom: 20px;
    }
    .stat { text-align: center; }
    .stat-num { font-size: 20px; font-weight: bold; color: #6366f1; }
    .stat-label { font-size: 10px; color: #94a3b8; text-transform: uppercase; }
    
    /* History */
    .history-item {
      padding: 12px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .history-item:last-child { border-bottom: none; }
    .history-category {
      font-size: 10px;
      color: #6366f1;
      text-transform: uppercase;
      font-weight: bold;
    }
    .history-text { font-size: 13px; margin-top: 4px; }
    
    /* Password */
    .password-display {
      font-family: monospace;
      font-size: 20px;
      text-align: center;
      padding: 20px;
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      letter-spacing: 3px;
      margin-bottom: 12px;
    }
    
    /* Chat */
    .chat-messages {
      max-height: 400px;
      overflow-y: auto;
      margin-bottom: 15px;
    }
    .chat-msg {
      padding: 12px 16px;
      border-radius: 16px;
      margin-bottom: 10px;
      max-width: 85%;
    }
    .chat-msg.bot {
      background: rgba(99, 102, 241, 0.2);
      border-bottom-left-radius: 4px;
    }
    .chat-msg.user {
      background: rgba(255,255,255,0.1);
      border-bottom-right-radius: 4px;
      margin-left: auto;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üê° Ezhik AI Hub</h1>
    <p>–¢–≤–æ–π –ª–∏—á–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
  </div>
  
  <div class="tabs">
    <button class="tab active" data-tab="ideas">üí° –ò–¥–µ–∏</button>
    <button class="tab" data-tab="brainstorm">üß† Brainstorm</button>
    <button class="tab" data-tab="names">üéØ –ù–∞–∑–≤–∞–Ω–∏—è</button>
    <button class="tab" data-tab="slogans">üìù –°–ª–æ–≥–∞–Ω—ã</button>
    <button class="tab" data-tab="chat">üí¨ –ß–∞—Ç</button>
    <button class="tab" data-tab="content">üì∞ –ö–æ–Ω—Ç–µ–Ω—Ç</button>
    <button class="tab" data-tab="random">üé≤ –†–∞–Ω–¥–æ–º</button>
    <button class="tab" data-tab="password">üîê –ü–∞—Ä–æ–ª–∏</button>
    <button class="tab" data-tab="code">üíª –ö–æ–¥</button>
  </div>
  
  <div class="content">
    <div class="stats-bar">
      <div class="stat">
        <div class="stat-num" id="stat-ideas">0</div>
        <div class="stat-label">–ò–¥–µ–π</div>
      </div>
      <div class="stat">
        <div class="stat-num" id="stat-brainstorms">0</div>
        <div class="stat-label">Brainstorms</div>
      </div>
      <div class="stat">
        <div class="stat-num" id="stat-chats">0</div>
        <div class="stat-label">–ß–∞—Ç–æ–≤</div>
      </div>
    </div>
    
    <!-- –ò–¥–µ–∏ -->
    <div class="tab-content active" id="tab-ideas">
      <div class="card">
        <select id="category">
          <option value="–±–∏–∑–Ω–µ—Å">üíº –ë–∏–∑–Ω–µ—Å</option>
          <option value="—Å—Ç–∞—Ä—Ç–∞–ø">üöÄ –°—Ç–∞—Ä—Ç–∞–ø</option>
          <option value="–∫–æ–Ω—Ç–µ–Ω—Ç">üì∫ –ö–æ–Ω—Ç–µ–Ω—Ç</option>
          <option value="3d">üé® 3D-–ø—Ä–æ–µ–∫—Ç</option>
          <option value="psx">üëæ PSX Assets</option>
          <option value="–∫–æ–¥">üíª IT-–ø—Ä–æ–µ–∫—Ç</option>
          <option value="–º–∞—Ä–∫–µ—Ç–∏–Ω–≥">üì£ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</option>
        </select>
        <button class="btn" id="generate-btn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ—é ‚ú®</button>
        <button class="btn btn-secondary" id="copy-btn" style="display:none;margin-top:10px;">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
      <div id="idea-result" class="result" style="display:none;"></div>
      <div class="card" id="history-card">
        <h3 style="margin-bottom: 12px;">üìú –ò—Å—Ç–æ—Ä–∏—è</h3>
        <div id="history-list"></div>
      </div>
    </div>
    
    <!-- Brainstorm -->
    <div class="tab-content" id="tab-brainstorm">
      <div class="card">
        <textarea id="brainstorm-input" placeholder="–û–ø–∏—à–∏ —Å–≤–æ—é –∏–¥–µ—é –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É..."></textarea>
        <select id="brainstorm-type">
          <option value="develop">–†–∞–∑–≤–∏—Ç—å –∏–¥–µ—é</option>
          <option value="questions">–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã</option>
          <option value="features">–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ñ–∏—á–∏</option>
          <option value="monetize">–ü—Ä–∏–¥—É–º–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é</option>
          <option value="audience">–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¶–ê</option>
        </select>
        <button class="btn" id="brainstorm-btn">–î—É–º–∞—é üß†</button>
      </div>
      <div id="brainstorm-result" class="result" style="display:none;"></div>
    </div>
    
    <!-- –ù–∞–∑–≤–∞–Ω–∏—è -->
    <div class="tab-content" id="tab-names">
      <div class="card">
        <input type="text" id="names-input" placeholder="–û —á–µ–º –ø—Ä–æ–µ–∫—Ç? (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –µ–¥—ã)">
        <select id="names-style">
          <option value="tech">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω—ã–π</option>
          <option value="friendly">–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π</option>
          <option value="premium">–ü—Ä–µ–º–∏—É–º</option>
          <option value="fun">–í–µ—Å—ë–ª—ã–π</option>
        </select>
        <button class="btn" id="names-btn">–ü—Ä–∏–¥—É–º–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è üéØ</button>
      </div>
      <div id="names-result" class="result" style="display:none;"></div>
    </div>
    
    <!-- –°–ª–æ–≥–∞–Ω—ã -->
    <div class="tab-content" id="tab-slogans">
      <div class="card">
        <input type="text" id="slogans-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –±—Ä–µ–Ω–¥–∞ –∏–ª–∏ –ø—Ä–æ–¥—É–∫—Ç–∞">
        <textarea id="slogans-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (—á—Ç–æ –¥–µ–ª–∞–µ—à—å, –¥–ª—è –∫–æ–≥–æ)"></textarea>
        <button class="btn" id="slogans-btn">–ü—Ä–∏–¥—É–º–∞—Ç—å —Å–ª–æ–≥–∞–Ω—ã üìù</button>
      </div>
      <div id="slogans-result" class="result" style="display:none;"></div>
    </div>
    
    <!-- –ß–∞—Ç -->
    <div class="tab-content" id="tab-chat">
      <div class="card">
        <div class="chat-messages" id="chat-messages"></div>
        <div style="display:flex;gap:10px;">
          <input type="text" id="chat-input" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..." style="flex:1;margin:0;">
          <button class="btn" id="chat-btn" style="width:auto;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
      </div>
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="tab-content" id="tab-content">
      <div class="card">
        <input type="text" id="content-topic" placeholder="–û —á—ë–º –ø–æ—Å—Ç?">
        <select id="content-platform">
          <option value="telegram">Telegram</option>
          <option value="twitter">Twitter/X</option>
          <option value="instagram">Instagram</option>
          <option value="linkedin">LinkedIn</option>
        </select>
        <select id="content-tone">
          <option value="friendly">–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π</option>
          <option value="professional">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π</option>
          <option value="humor">–° —é–º–æ—Ä–æ–º</option>
          <option value="expert">–≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π</option>
        </select>
        <button class="btn" id="content-btn">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç üì∞</button>
      </div>
      <div id="content-result" class="result" style="display:none;"></div>
    </div>
    
    <!-- –†–∞–Ω–¥–æ–º -->
    <div class="tab-content" id="tab-random">
      <div class="tool-grid">
        <div class="tool-item" onclick="generateRandom('joke')">
          <div class="tool-icon">üòÇ</div>
          <div class="tool-name">–®—É—Ç–∫–∞</div>
        </div>
        <div class="tool-item" onclick="generateRandom('fact')">
          <div class="tool-icon">üí°</div>
          <div class="tool-name">–§–∞–∫—Ç</div>
        </div>
        <div class="tool-item" onclick="generateRandom('insight')">
          <div class="tool-icon">ü§î</div>
          <div class="tool-name">–ò–Ω—Å–∞–π—Ç</div>
        </div>
        <div class="tool-item" onclick="generateRandom('tip')">
          <div class="tool-icon">‚ö°</div>
          <div class="tool-name">–°–æ–≤–µ—Ç</div>
        </div>
      </div>
      <div id="random-result" class="result" style="display:none;"></div>
    </div>
    
    <!-- –ü–∞—Ä–æ–ª–∏ -->
    <div class="tab-content" id="tab-password">
      <div class="card">
        <div class="password-display" id="password-display">---</div>
        <div style="display:flex;gap:10px;margin-bottom:12px;">
          <input type="range" id="password-length" min="8" max="32" value="16" style="flex:1;margin:0;">
          <span id="password-length-val">16</span>
        </div>
        <div class="tool-grid">
          <div class="tool-item" onclick="generatePassword()">
            <div class="tool-icon">üé≤</div>
            <div class="tool-name">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</div>
          </div>
          <div class="tool-item" onclick="copyPassword()">
            <div class="tool-icon">üìã</div>
            <div class="tool-name">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- –ö–æ–¥ -->
    <div class="tab-content" id="tab-code">
      <div class="card">
        <select id="code-language">
          <option value="Python">üêç Python</option>
          <option value="Go">üî∑ Go</option>
          <option value="JavaScript">üìú JavaScript</option>
          <option value="HTML/CSS">üåê HTML/CSS</option>
          <option value="Bash">üíª Bash</option>
          <option value="SQL">üóÑÔ∏è SQL</option>
        </select>
        <textarea id="code-task" placeholder="–û–ø–∏—à–∏ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å...&#10;–ù–∞–ø—Ä–∏–º–µ—Ä: —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ email –Ω–∞ Python"></textarea>
        <button class="btn" id="code-btn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ üíª</button>
      </div>
      <div id="code-result" class="result" style="display:none;max-height:400px;overflow:auto;"></div>
    </div>
  </div>

  <script>
    const API_URL = window.location.origin;
    const Telegram = window.Telegram?.WebApp;
    if (Telegram) { Telegram.expand(); Telegram.ready(); }

    // Stats
    let stats = { ideas: 0, brainstorms: 0, chats: 0 };
    let chatHistory = [];

    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
      });
    });

    // Load stats
    loadStats();
    function loadStats() {
      try {
        const saved = JSON.parse(localStorage.getItem('ezhik_stats') || '{}');
        stats = { ...stats, ...saved };
        updateStatsDisplay();
      } catch(e) {}
    }
    function updateStatsDisplay() {
      document.getElementById('stat-ideas').textContent = stats.ideas;
      document.getElementById('stat-brainstorms').textContent = stats.brainstorms;
      document.getElementById('stat-chats').textContent = stats.chats;
    }
    function saveStats() {
      localStorage.setItem('ezhik_stats', JSON.stringify(stats));
      updateStatsDisplay();
    }

    // AI Call wrapper
    async function callAI(prompt, systemPrompt = '–¢—ã –ø–æ–ª–µ–∑–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.') {
      const response = await fetch(API_URL + '/api/ai', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt, systemPrompt })
      });
      if (!response.ok) throw new Error('API error');
      const data = await response.json();
      return data.response;
    }

    // Ideas
    document.getElementById('generate-btn').addEventListener('click', async () => {
      const btn = document.getElementById('generate-btn');
      const result = document.getElementById('idea-result');
      const category = document.getElementById('category').value;
      
      btn.disabled = true;
      btn.textContent = '–î—É–º–∞—é... üí≠';
      result.style.display = 'block';
      result.className = 'result loading';
      result.textContent = '–ï–∂–∏–∫ –¥—É–º–∞–µ—Ç...';
      
      try {
        const idea = await callAI(
          `–ü—Ä–∏–¥—É–º–∞–π –æ–¥–Ω—É –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –∏–¥–µ—é –¥–ª—è ${category}. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∏ –ø–æ–ª–µ–∑–Ω–æ–µ.`,
          '–¢—ã –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–¥–µ–π. –ü—Ä–∏–¥—É–º—ã–≤–∞–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–¥–µ–∏.'
        );
        result.className = 'result';
        result.textContent = idea;
        document.getElementById('copy-btn').style.display = 'block';
        stats.ideas++;
        saveStats();
      } catch(e) {
        result.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
      }
      btn.disabled = false;
      btn.textContent = '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ—é ‚ú®';
    });

    // Brainstorm
    document.getElementById('brainstorm-btn').addEventListener('click', async () => {
      const btn = document.getElementById('brainstorm-btn');
      const result = document.getElementById('brainstorm-result');
      const input = document.getElementById('brainstorm-input').value;
      const type = document.getElementById('brainstorm-type').value;
      
      if (!input) { result.textContent = '–ù–∞–ø–∏—à–∏ –∏–¥–µ—é!'; result.style.display = 'block'; return; }
      
      const prompts = {
        develop: `–†–∞–∑–≤–µ—Ä–Ω–∏ –∏ —É–ª—É—á—à–∏ —ç—Ç—É –∏–¥–µ—é: "${input}". –î–æ–±–∞–≤—å –¥–µ—Ç–∞–ª–∏, –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.`,
        questions: `–ó–∞–¥–∞–π 5-7 —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —ç—Ç–æ–π –∏–¥–µ–µ: "${input}". –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, —Å—Ç–æ–∏—Ç –ª–∏ –µ—ë —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å.`,
        features: `–ü—Ä–µ–¥–ª–æ–∂–∏ 10 —Ñ–∏—á –¥–ª—è: "${input}". –û—Ç –±–∞–∑–æ–≤—ã—Ö –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö.`,
        monetize: `–ü—Ä–∏–¥—É–º–∞–π 7-10 —Å–ø–æ—Å–æ–±–æ–≤ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è: "${input}".`,
        audience: `–û–ø–∏—à–∏ —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é –¥–ª—è: "${input}". –í–æ–∑—Ä–∞—Å—Ç, –∏–Ω—Ç–µ—Ä–µ—Å—ã, –±–æ–ª–∏.`
      };
      
      btn.disabled = true;
      btn.textContent = '–î—É–º–∞—é... üß†';
      result.style.display = 'block';
      result.className = 'result loading';
      result.textContent = '–ï–∂–∏–∫ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç...';
      
      try {
        const response = await callAI(prompts[type], '–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –î–∞–≤–∞–π –ø–æ–ª–µ–∑–Ω—ã–µ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.');
        result.className = 'result';
        result.textContent = response;
        stats.brainstorms++;
        saveStats();
      } catch(e) {
        result.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
      }
      btn.disabled = false;
      btn.textContent = '–î—É–º–∞—é üß†';
    });

    // Names
    document.getElementById('names-btn').addEventListener('click', async () => {
      const btn = document.getElementById('names-btn');
      const result = document.getElementById('names-result');
      const input = document.getElementById('names-input').value;
      const style = document.getElementById('names-style').value;
      
      if (!input) { result.textContent = '–û–ø–∏—à–∏ –ø—Ä–æ–µ–∫—Ç!'; result.style.display = 'block'; return; }
      
      btn.disabled = true;
      btn.textContent = '–ü—Ä–∏–¥—É–º—ã–≤–∞—é... üéØ';
      result.style.display = 'block';
      result.className = 'result loading';
      
      try {
        const stylePrompts = {
          tech: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω—ã–µ, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ, –≤–æ–∑–º–æ–∂–Ω–æ —Å —Ü–∏—Ñ—Ä–∞–º–∏',
          friendly: '–î—Ä—É–∂–µ–ª—é–±–Ω—ã–µ, —Ç—ë–ø–ª—ã–µ, –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏–µ—Å—è',
          premium: '–ü—Ä–µ–º–∏—É–º, —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ, –¥–æ—Ä–æ–≥–∏–µ',
          fun: '–í–µ—Å—ë–ª—ã–µ, –∏–≥—Ä–∏–≤—ã–µ, —è—Ä–∫–∏–µ'
        };
        const response = await callAI(
          `–ü—Ä–∏–¥—É–º–∞–π 10 –Ω–∞–∑–≤–∞–Ω–∏–π –¥–ª—è: "${input}". –°—Ç–∏–ª—å: ${stylePrompts[style]}. –û—Ç–≤–µ—á–∞–π —Å–ø–∏—Å–∫–æ–º, –∫—Ä–∞—Ç–∫–æ.`,
          '–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–µ–π–º–∏–Ω–≥—É. –ü—Ä–∏–¥—É–º—ã–≤–∞–π –∫—Ä—É—Ç—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è.'
        );
        result.className = 'result';
        result.textContent = response;
      } catch(e) {
        result.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
      }
      btn.disabled = false;
      btn.textContent = '–ü—Ä–∏–¥—É–º–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è üéØ';
    });

    // Slogans
    document.getElementById('slogans-btn').addEventListener('click', async () => {
      const btn = document.getElementById('slogans-btn');
      const result = document.getElementById('slogans-result');
      const input = document.getElementById('slogans-input').value;
      const desc = document.getElementById('slogans-desc').value;
      
      if (!input) { result.textContent = '–ù–∞–ø–∏—à–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ!'; result.style.display = 'block'; return; }
      
      btn.disabled = true;
      result.style.display = 'block';
      result.className = 'result loading';
      
      try {
        const response = await callAI(
          `–ü—Ä–∏–¥—É–º–∞–π 8 —Å–ª–æ–≥–∞–Ω–æ–≤ –¥–ª—è: "${input}". ${desc ? '–ö–æ–Ω—Ç–µ–∫—Å—Ç: ' + desc : ''} –ö–æ—Ä–æ—Ç–∫–∏–µ, –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏–µ—Å—è.`,
          '–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É. –ü—Ä–∏–¥—É–º—ã–≤–∞–π —Ü–µ–ø–ª—è—é—â–∏–µ —Å–ª–æ–≥–∞–Ω—ã.'
        );
        result.className = 'result';
        result.textContent = response;
      } catch(e) {
        result.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
      }
      btn.disabled = false;
    });

    // Chat
    function addChatMessage(text, isUser = false) {
      const container = document.getElementById('chat-messages');
      const div = document.createElement('div');
      div.className = 'chat-msg ' + (isUser ? 'user' : 'bot');
      div.textContent = text;
      container.appendChild(div);
      container.scrollTop = container.scrollHeight;
    }

    document.getElementById('chat-btn').addEventListener('click', async () => {
      const input = document.getElementById('chat-input');
      const text = input.value.trim();
      if (!text) return;
      
      addChatMessage(text, true);
      input.value = '';
      stats.chats++;
      saveStats();
      
      const systemPrompt = '–¢—ã Ezhik ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ, —Å —é–º–æ—Ä–æ–º, –ø–æ-—Ä—É—Å—Å–∫–∏. –ë—É–¥—å –ø–æ–ª–µ–∑–Ω—ã–º.';
      chatHistory.push({ role: 'user', content: text });
      
      try {
        const historyText = chatHistory.map(m => m.role + ': ' + m.content).join('\n');
        const response = await callAI(historyText, systemPrompt);
        addChatMessage(response);
        chatHistory.push({ role: 'assistant', content: response });
      } catch(e) {
        addChatMessage('–û—à–∏–±–∫–∞: ' + e.message);
      }
    });

    // Content
    document.getElementById('content-btn').addEventListener('click', async () => {
      const btn = document.getElementById('content-btn');
      const result = document.getElementById('content-result');
      const topic = document.getElementById('content-topic').value;
      const platform = document.getElementById('content-platform').value;
      const tone = document.getElementById('content-tone').value;
      
      if (!topic) { result.textContent = '–ù–∞–ø–∏—à–∏ —Ç–µ–º—É!'; result.style.display = 'block'; return; }
      
      btn.disabled = true;
      result.style.display = 'block';
      result.className = 'result loading';
      
      const platformLimits = { telegram: '–¥–æ 300 —Å–∏–º–≤–æ–ª–æ–≤', twitter: '–¥–æ 280 —Å–∏–º–≤–æ–ª–æ–≤', instagram: '—Å —ç–º–æ–¥–∑–∏', linkedin: '–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ' };
      
      try {
        const response = await callAI(
          `–ù–∞–ø–∏—à–∏ –ø–æ—Å—Ç –¥–ª—è ${platform} –Ω–∞ —Ç–µ–º—É: "${topic}". –¢–æ–Ω: ${tone}. –§–æ—Ä–º–∞—Ç: ${platformLimits[platform]}.`,
          '–¢—ã SMM-—ç–∫—Å–ø–µ—Ä—Ç. –ü–∏—à–∏ —Ü–µ–ø–ª—è—é—â–∏–µ –ø–æ—Å—Ç—ã.'
        );
        result.className = 'result';
        result.textContent = response;
      } catch(e) {
        result.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
      }
      btn.disabled = false;
    });

    // Random
    async function generateRandom(type) {
      const result = document.getElementById('random-result');
      result.style.display = 'block';
      result.className = 'result loading';
      
      const prompts = {
        joke: '–†–∞—Å—Å–∫–∞–∂–∏ –æ–¥–Ω—É —Å–º–µ—à–Ω—É—é —à—É—Ç–∫—É –ø—Ä–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤ –∏–ª–∏ AI.',
        fact: '–†–∞—Å—Å–∫–∞–∂–∏ –æ–¥–∏–Ω –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç –æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö –∏–ª–∏ –Ω–∞—É–∫–µ.',
        insight: '–î–∞–π –æ–¥–∏–Ω –ø–æ–ª–µ–∑–Ω—ã–π –∏–Ω—Å–∞–π—Ç –ø—Ä–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–ª–∏ –º—ã—à–ª–µ–Ω–∏–µ.',
        tip: '–î–∞–π –æ–¥–∏–Ω –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é –∏–ª–∏ –¥–∏–∑–∞–π–Ω—É.'
      };
      
      try {
        const response = await callAI(prompts[type], '–û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.');
        result.className = 'result';
        result.textContent = response;
      } catch(e) {
        result.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
      }
    }

    // Password
    document.getElementById('password-length').addEventListener('input', (e) => {
      document.getElementById('password-length-val').textContent = e.target.value;
    });

    function generatePassword() {
      const length = parseInt(document.getElementById('password-length').value);
      const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
      let password = '';
      for (let i = 0; i < length; i++) {
        password += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      document.getElementById('password-display').textContent = password;
    }

    function copyPassword() {
      const password = document.getElementById('password-display').textContent;
      if (password === '---') return;
      navigator.clipboard.writeText(password);
      alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');
    }

    // Init password
    generatePassword();

    // Copy button
    document.getElementById('copy-btn').addEventListener('click', () => {
      const text = document.getElementById('idea-result').textContent;
      navigator.clipboard.writeText(text);
      const btn = document.getElementById('copy-btn');
      btn.textContent = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
      setTimeout(() => btn.textContent = 'üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å', 2000);
    });

    // Code generator
    document.getElementById('code-btn').addEventListener('click', async () => {
      const btn = document.getElementById('code-btn');
      const result = document.getElementById('code-result');
      const language = document.getElementById('code-language').value;
      const task = document.getElementById('code-task').value;
      
      if (!task) { result.textContent = '–û–ø–∏—à–∏ –∑–∞–¥–∞—á—É!'; result.style.display = 'block'; return; }
      
      btn.disabled = true;
      btn.textContent = '–ü–∏—à—É –∫–æ–¥... ‚å®Ô∏è';
      result.style.display = 'block';
      result.className = 'result loading';
      result.textContent = '–ï–∂–∏–∫ –∫–æ–¥–∏—Ç...';
      
      try {
        const response = await fetch(API_URL + '/api/code', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ language, task })
        });
        if (!response.ok) throw new Error('API error');
        const data = await response.json();
        result.className = 'result';
        result.textContent = data.code || data.error || '–ì–æ—Ç–æ–≤–æ!';
      } catch(e) {
        result.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
      }
      btn.disabled = false;
      btn.textContent = '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ üíª';
    });
  </script>
</body>
</html>
